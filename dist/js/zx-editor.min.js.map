{"version":3,"file":"zx-editor.min.js","sources":["../../src/js/dom-class/helper.js","../../src/js/util/index.js","../../node_modules/_ssr-window@1.0.1@ssr-window/dist/ssr-window.esm.js","../../src/js/dom-class/index.js","../../src/js/cursor-class/index.js","../../src/js/expansion-panel/index.js","../../src/js/events/paste.js","../../src/js/events/index.js","../../src/js/events/handlers.js","../../src/js/custom-events/index.js","../../src/js/image-handler/helper.js","../../src/js/image-handler/index.js","../../src/js/config.js","../../src/js/toolbar/index.js","../../src/js/init/style-expansion-panel.js","../../src/js/init/toolbar.js","../../src/js/init/select-picture-btn.js","../../src/js/index.js","../../src/js/init/extend-prototype.js","../../src/js/init/watcher.js","../../src/js/init/init-dom.js","../../src/js/init/init-style.js"],"sourcesContent":["/**\n * Created by Capricorncd.\n * User: https://github.com/capricorncd\n * Date: 2019/04/18 22:57\n */\nimport util from '../util/index'\n\nexport function unique(arr) {\n  const uniqueArray = []\n  for (let i = 0; i < arr.length; i += 1) {\n    if (uniqueArray.indexOf(arr[i]) === -1) uniqueArray.push(arr[i])\n  }\n  return uniqueArray\n}\n\n/**\n * 改变元素的nodeName\n * @param oldNode\n * @param tagName target nodeName\n * @return {*}\n */\nexport function changeNodeName (oldNode, tagName) {\n  let oldNodeName = oldNode.nodeName.toLowerCase()\n  // check tagName\n  if (typeof tagName !== 'string' || util.strip(tagName).length === 0) {\n    throw new TypeError(`changeNodeName(oldNode, tagName) 'tagName' is ${tagName}, should be a 'string'`)\n  }\n  if (oldNodeName === tagName.toLowerCase()) return oldNode\n  let el = document.createElement(tagName)\n  // 非Element节点，当字符串节点处理\n  if (oldNode.nodeType !== 1) {\n    el.appendChild(oldNode)\n  } else {\n   // 获取属性class, style, id\n    if (oldNode.className) el.className = oldNode.className\n    if (oldNode.id) el.id = oldNode.id\n    let style = oldNode.getAttribute('style')\n    if (style) el.setAttribute('style', style)\n    el.innerHTML = oldNode.innerHTML\n  }\n  // replace Node on document\n  if (oldNode.parentNode) {\n    oldNode.parentNode.replaceChild(el, oldNode)\n  }\n  return el\n}\n\nexport function addEventListener (el, eventType, fn, useCapture) {\n  if (el.addEventListener) {\n    el.addEventListener(eventType, fn, useCapture)\n  } else if (el.attachEvent) {\n    el.attachEvent(eventType, fn)\n  } else {\n    el[`on${eventType}`] = fn\n  }\n}\n\nexport function removeEventListener (el, eventType, fn, useCapture) {\n  if (el.removeEventListener) {\n    el.removeEventListener(eventType, fn, useCapture)\n  } else if (el.detachEvent) {\n    el.detachEvent(eventType, fn)\n  } else {\n    el[`on${eventType}`] = null\n  }\n}\n","/**\n * Created by Capricorncd.\n * Date: 2019/04/15 13:16\n * Copyright © 2017-present, https://github.com/capricorncd\n */\nimport {\n  changeNodeName,\n  unique\n} from '../dom-class/helper'\n\nconst arr = []\n// Support: Android <=4.0 only\n// Make sure we trim BOM and NBSP\nlet regTrim = /^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g\n/**\n * 转换为整数\n * @param n\n * @returns {*}\n */\nfunction int (n) {\n  let num = parseInt(n)\n  return isNaN(num) ? 0 : num\n}\n\n/**\n * 去除字符串首尾空格\n * @param str\n * @returns {string}\n */\nfunction trim (str) {\n  return str ? str.toString().replace(regTrim, '') : ''\n}\n\n/**\n * 将伪数组，转化为数组\n * @param ArrayLike\n * @param index\n * @return {T[]}\n */\nfunction slice (ArrayLike, index) {\n  return arr.slice.call(ArrayLike, int(index))\n}\n\n/**\n * 去除字符串多余空格\n * 除首尾外，中间连续空格被替换为一个空格\n * @param str\n * @return {string}\n */\nfunction strip (str) {\n  return trim(str).replace(/\\s+/g, ' ')\n}\n\n/**\n * 是否为Element对象\n * @param el\n * @return {*|boolean}\n */\nfunction isElement (el) {\n  return isObject(el) && el.nodeType\n}\n\n/**\n * 是否为对象\n * @param obj\n * @param isAbsolute 必须满足父级原型为Object的对象\n * @return {*|boolean}\n */\nfunction isObject (obj, isAbsolute) {\n  let isObj = obj && typeof obj === 'object'\n  return isAbsolute ? isObj && obj.toString() === '[object Object]' : isObj\n}\n\n/**\n * 移除html标签\n * @param str\n * @return {string}\n */\nfunction removeHtmlTags (str) {\n  str = (str + '').replace(/<\\/?.+?>/g, '')\n  return strip(str)\n}\n\n/**\n * string to hump format\n * @param str line-height: lineHeight\n * @return {string}\n */\nfunction toHump (str) {\n  return strip(str).replace(/([-_\\s]+\\w)/g, (match, $1) => {\n    console.log(match, $1)\n    return $1[1].toUpperCase()\n  })\n}\n\nexport default {\n  changeNodeName,\n  int,\n  isElement,\n  isObject,\n  removeHtmlTags,\n  slice,\n  strip,\n  trim,\n  toHump,\n  unique\n}\n","/**\n * SSR Window 1.0.1\n * Better handling for window object in SSR environment\n * https://github.com/nolimits4web/ssr-window\n *\n * Copyright 2018, Vladimir Kharlampidi\n *\n * Licensed under MIT\n *\n * Released on: July 18, 2018\n */\nvar doc = (typeof document === 'undefined') ? {\n  body: {},\n  addEventListener: function addEventListener() {},\n  removeEventListener: function removeEventListener() {},\n  activeElement: {\n    blur: function blur() {},\n    nodeName: '',\n  },\n  querySelector: function querySelector() {\n    return null;\n  },\n  querySelectorAll: function querySelectorAll() {\n    return [];\n  },\n  getElementById: function getElementById() {\n    return null;\n  },\n  createEvent: function createEvent() {\n    return {\n      initEvent: function initEvent() {},\n    };\n  },\n  createElement: function createElement() {\n    return {\n      children: [],\n      childNodes: [],\n      style: {},\n      setAttribute: function setAttribute() {},\n      getElementsByTagName: function getElementsByTagName() {\n        return [];\n      },\n    };\n  },\n  location: { hash: '' },\n} : document; // eslint-disable-line\n\nvar win = (typeof window === 'undefined') ? {\n  document: doc,\n  navigator: {\n    userAgent: '',\n  },\n  location: {},\n  history: {},\n  CustomEvent: function CustomEvent() {\n    return this;\n  },\n  addEventListener: function addEventListener() {},\n  removeEventListener: function removeEventListener() {},\n  getComputedStyle: function getComputedStyle() {\n    return {\n      getPropertyValue: function getPropertyValue() {\n        return '';\n      },\n    };\n  },\n  Image: function Image() {},\n  Date: function Date() {},\n  screen: {},\n  setTimeout: function setTimeout() {},\n  clearTimeout: function clearTimeout() {},\n} : window; // eslint-disable-line\n\nexport { win as window, doc as document };\n","/**\n * Created by Capricorncd.\n * User: https://github.com/capricorncd\n * Date: 2019/04/17 20:36\n */\nimport util from '../util/index'\nimport { document, window } from 'ssr-window'\nimport { unique, changeNodeName, addEventListener, removeEventListener } from './helper'\n\n/**\n * DOM操作\n * @param selector\n * @param context\n * @constructor\n */\nexport function ZxEditorQuery (selector, context) {\n\n  // HANDLE: $(\"\"), $(null), $(undefined), $(false)\n  if ( !selector ) return this\n\n  if (selector instanceof ZxEditorQuery) return selector\n\n  let doms\n\n  // Handle HTML strings\n  if ( typeof selector === 'string' ) {\n    if ( selector[ 0 ] === '<' &&\n      selector[ selector.length - 1 ] === '>' && selector.length >= 3 ) {\n\n      // Assume that strings that start and end with <> are HTML and skip the regex check\n      let tempDiv = document.createElement('div')\n      tempDiv.innerHTML = selector\n      doms = util.slice(tempDiv.childNodes)\n    } else if (/^[#\\w\\d_,\\s-]+$/.test(selector)) {\n      if (context instanceof ZxEditorQuery) {\n        context =  context[0]\n      }\n      context = util.isElement(context) && context.nodeType === 1 ? context : document\n      doms = util.slice(context.querySelectorAll(util.strip(selector)))\n    }\n    // HANDLE: $(DOMElement)\n  } else if ( selector.nodeType || selector === window || selector === document ) {\n    doms = [selector]\n    // HANDLE: $(DOMElements)\n  } else if (Array.isArray(selector) && selector.every(item => util.isElement(item))) {\n    doms = selector\n  }\n\n  if (doms) {\n    doms.forEach((el, i) => {\n      this[i] = el\n    })\n    this.length = doms.length\n  }\n  return this\n}\n\n/**\n * prototype\n */\nZxEditorQuery.prototype = {\n  /**\n   * constructor\n   */\n  constructor: ZxEditorQuery,\n\n  /**\n   * length\n   */\n  length: 0,\n\n  /**\n   * ********************************************\n   * find item\n   * ********************************************\n   */\n\n  /**\n   * get children\n   * @param selector\n   * @return {*|jQuery|HTMLElement}\n   */\n  children (selector) {\n    const children = []\n    for (let i = 0; i < this.length; i++) {\n      const childNodes = this[i].childNodes\n\n      for (let j = 0; j < childNodes.length; j++) {\n        if (!selector) {\n          if (childNodes[j].nodeType === 1) children.push(childNodes[j])\n        } else if (childNodes[j].nodeType === 1 && $(childNodes[j]).is(selector)) {\n          children.push(childNodes[j])\n        }\n      }\n    }\n    return $(unique(children))\n  },\n\n  /**\n   * Find the nearest matching element in the parent\n   * @param selector\n   * @return {*}\n   */\n  closest (selector) {\n    let closest = this\n    if (typeof selector === 'undefined') {\n      return new $()\n    }\n    if (!closest.is(selector)) {\n      closest = closest.parents(selector).eq(0)\n    }\n    return closest\n  },\n\n  /**\n   * equal\n   * @param i\n   * @return {*|jQuery|HTMLElement}\n   */\n  eq (i) {\n    let len = this.length\n    let index = util.int(i) + (i < 0 ? len : 0)\n    return $(this[index])\n  },\n\n  /**\n   * find item\n   * @param selector\n   * @return {*|jQuery|HTMLElement}\n   */\n  find (selector) {\n    let found\n    let foundElements = []\n    for (let i = 0; i < this.length; i++) {\n      if (this[i].nodeType !== 1) continue\n      found = this[i].querySelectorAll(selector)\n      for (let j = 0; j < found.length; j++) {\n        foundElements.push(found[j])\n      }\n    }\n    return $(foundElements)\n  },\n\n  /**\n   * get first child\n   * @return {*|jQuery|HTMLElement}\n   */\n  firstChild () {\n    return this.children().eq(0)\n  },\n\n  /**\n   * get last child\n   * @return {*|jQuery|HTMLElement}\n   */\n  lastChild () {\n    return this.children().eq(-1)\n  },\n\n  /**\n   * get next siblings\n   * @param selector\n   * @return {*|jQuery|HTMLElement}\n   */\n  next (selector) {\n    if (this.length > 0) {\n      if (selector) {\n        if (this[0].nextElementSibling && $(this[0].nextElementSibling).is(selector)) {\n          return $([this[0].nextElementSibling])\n        }\n        return $()\n      }\n\n      if (this[0].nextElementSibling) return $([this[0].nextElementSibling])\n    }\n    return $()\n  },\n\n  /**\n   * get nearest parents\n   * @param selector\n   * @return {*|jQuery|HTMLElement}\n   */\n  parent (selector) {\n    const parents = []\n    for (let i = 0; i < this.length; i++) {\n      if (this[i].parentNode !== null) {\n        if (selector) {\n          if ($(this[i].parentNode).is(selector)) parents.push(this[i].parentNode)\n        } else {\n          parents.push(this[i].parentNode)\n        }\n      }\n    }\n    return $(unique(parents))\n  },\n\n  /**\n   * get all parents\n   * @param selector\n   * @return {*|jQuery|HTMLElement}\n   */\n  parents (selector) {\n    const parents = []\n    for (let i = 0; i < this.length; i++) {\n      let parent = this[i].parentNode\n      while (parent) {\n        if (selector) {\n          if ($(parent).is(selector)) parents.push(parent)\n        } else {\n          parents.push(parent)\n        }\n        parent = parent.parentNode\n      }\n    }\n    return $(unique(parents))\n  },\n\n  /**\n   * ********************************************\n   * class\n   * ********************************************\n   */\n\n  /**\n   * add className\n   * @param className\n   * @return {ZxEditorQuery}\n   */\n  addClass (className) {\n    if (!className) return this\n    let classes = className.split(' ')\n    classes.forEach(cls => {\n      for (let j = 0; j < this.length; j++) {\n        this[j] && this[j].classList && this[j].classList.add(cls)\n      }\n    })\n    return this\n  },\n\n  /**\n   * remove className\n   * @param className\n   * @return {ZxEditorQuery}\n   */\n  removeClass (className) {\n    let classes = className.split(' ')\n    classes.forEach(cls => {\n      for (let j = 0; j < this.length; j++) {\n        this[j] && this[j].classList && this[j].classList.remove(cls)\n      }\n    })\n    return this\n  },\n\n  /**\n   * check className\n   * @param className\n   * @return {boolean}\n   */\n  hasClass (className) {\n    if (!this[0]) return false\n    return this[0].classList.contains(className)\n  },\n\n  /**\n   * ********************************************\n   * attribute, data\n   * ********************************************\n   */\n\n  /**\n   * get/set attribute\n   * @param attrs attribute or object\n   * @param value\n   * @return {*}\n   */\n  attr (attrs, value) {\n    if (arguments.length === 1 && typeof attrs === 'string') {\n      // Get attr\n      if (this[0]) return this[0].getAttribute(attrs)\n      return void 0\n    }\n\n    // Set attrs\n    for (let i = 0; i < this.length; i++) {\n      if (arguments.length === 2) {\n        // String\n        this[i].setAttribute(attrs, value)\n      } else {\n        // Object\n        for (let attr in attrs) {\n          this[i][attr] = attrs[attr]\n          this[i].setAttribute(attr, attrs[attr])\n        }\n      }\n    }\n    return this\n  },\n\n  /**\n   * remove attribute\n   * @param attr\n   * @return {ZxEditorQuery}\n   */\n  removeAttr (attr) {\n    for (let i = 0; i < this.length; i++) {\n      this[i].removeAttribute(attr)\n    }\n    return this\n  },\n\n  /**\n   * get/set data-\n   * @param key\n   * @param value\n   * @return {*}\n   */\n  data (key, value) {\n    let el\n    if (typeof value === 'undefined') {\n      el = this[0]\n      if (el) {\n        if (el.dataStorage) return el.dataStorage[key]\n        let val = el.getAttribute(`data-${key}`)\n        return /^\\d+\\.?\\d*$/.test(val) ? +val : val\n      }\n      return undefined\n    }\n\n    // Set value\n    for (let i = 0; i < this.length; i++) {\n      el = this[i]\n      if (!el.dataStorage) el.dataStorage = {}\n      el.dataStorage[key] = value\n    }\n    return this\n  },\n\n  /**\n   * ********************************************\n   * insert node\n   * ********************************************\n   */\n\n  /**\n   * appendChild\n   * @param args\n   * @return {ZxEditorQuery}\n   */\n  append (...args) {\n    let newChild\n\n    for (let k = 0; k < args.length; k++) {\n      newChild = args[k];\n      for (let i = 0; i < this.length; i++) {\n        if (typeof newChild === 'string') {\n          const tempDiv = document.createElement('div')\n          tempDiv.innerHTML = newChild\n          while (tempDiv.firstChild) {\n            this[i].appendChild(tempDiv.firstChild)\n          }\n        } else if (newChild instanceof ZxEditorQuery) {\n          for (let j = 0; j < newChild.length; j++) {\n            this[i].appendChild(newChild[j])\n          }\n        } else {\n          this[i].appendChild(newChild)\n        }\n      }\n    }\n    return this\n  },\n\n  /**\n   * append child to parent\n   * @param parent\n   * @return {ZxEditorQuery}\n   */\n  appendTo (parent) {\n    $(parent).append(this)\n    return this\n  },\n\n  /**\n   * insert after selector\n   * @param selector\n   */\n  insertAfter(selector) {\n    const after = $(selector)\n    for (let i = 0; i < this.length; i++) {\n      if (after.length === 1) {\n        after[0].parentNode.insertBefore(this[i], after[0].nextSibling)\n      } else if (after.length > 1) {\n        for (let j = 0; j < after.length; j++) {\n          after[j].parentNode.insertBefore(this[i].cloneNode(true), after[j].nextSibling)\n        }\n      }\n    }\n  },\n  insertBefore (selector) {\n    const before = $(selector)\n    for (let i = 0; i < this.length; i++) {\n      if (before.length === 1) {\n        before[0].parentNode.insertBefore(this[i], before[0])\n      } else if (before.length > 1) {\n        for (let j = 0; j < before.length; j++) {\n          before[j].parentNode.insertBefore(this[i].cloneNode(true), before[j])\n        }\n      }\n    }\n  },\n  prepend (newChild) {\n    let i\n    let j\n    for (i = 0; i < this.length; i++) {\n      if (typeof newChild === 'string') {\n        const tempDiv = document.createElement('div')\n        tempDiv.innerHTML = newChild\n        for (j = tempDiv.childNodes.length - 1; j >= 0; j--) {\n          this[i].insertBefore(tempDiv.childNodes[j], this[i].childNodes[0])\n        }\n      } else if (newChild instanceof ZxEditorQuery) {\n        for (j = 0; j < newChild.length; j++) {\n          this[i].insertBefore(newChild[j], this[i].childNodes[0])\n        }\n      } else {\n        this[i].insertBefore(newChild, this[i].childNodes[0])\n      }\n    }\n    return this\n  },\n  prependTo (parent) {\n    $(parent).prepend(this)\n    return this\n  },\n\n  /**\n   * replace child\n   * @param selector\n   * @return {ZxEditorQuery}\n   */\n  replace (selector) {\n    let newChild = $(selector)\n    let parentNode\n    for (let i = 0; i < this.length; i++) {\n      parentNode = this[i].parentNode\n      if (parentNode) {\n        parentNode.replaceChild(newChild[0], this[i])\n      }\n    }\n    return this\n  },\n\n  /**\n   * remove item\n   * @param index\n   * @return {ZxEditorQuery}\n   */\n  remove (index) {\n    let el\n    if (typeof index !== 'number') {\n      for (let i = 0; i < this.length; i++) {\n        el = this[i]\n        if (el.parentNode) el.parentNode.removeChild(el)\n      }\n    } else {\n      el = this[index]\n      if (el && el.parentNode) el.parentNode.removeChild(el)\n    }\n    return this\n  },\n\n  /**\n   * ********************************************\n   * check\n   * ********************************************\n   */\n\n  /**\n   * is\n   * @param selector\n   * @return {*}\n   */\n  is (selector) {\n    const el = this[0]\n    let compareWith\n    let i\n    if (!el || typeof selector === 'undefined') return false;\n    if (typeof selector === 'string') {\n      if (el.matches) return el.matches(selector)\n      else if (el.webkitMatchesSelector) return el.webkitMatchesSelector(selector)\n      else if (el.msMatchesSelector) return el.msMatchesSelector(selector)\n\n      compareWith = $(selector)\n      for (i = 0; i < compareWith.length; i++) {\n        if (compareWith[i] === el) return true\n      }\n      return false\n    } else if (selector === document) return el === document\n    else if (selector === window) return el === window\n\n    if (selector.nodeType || selector instanceof ZxEditorQuery) {\n      compareWith = selector.nodeType ? [selector] : selector\n      for (i = 0; i < compareWith.length; i++) {\n        if (compareWith[i] === el) return true\n      }\n      return false\n    }\n    return false\n  },\n  isTextNode () {\n    let el = this[0]\n    if (!el || !el.nodeType) return false\n    return el.nodeType === 3\n  },\n  /**\n   * 子元素（不包含br）是否为空\n   * @return {boolean}\n   */\n  isEmpty () {\n    return !util.strip(this.text()) && !this.find('img, video, audio')[0]\n  },\n  /**\n   * target是否为this的第一个子元素\n   * @param target\n   * @return {boolean}\n   */\n  isFirstChildren (target) {\n    return this.children().eq(0).is(target)\n  },\n  /**\n   * target是否为this的最后一个子元素\n   * @param target\n   * @return {boolean}\n   */\n  isLastChildren (target) {\n    return this.children().eq(-1).is(target)\n  },\n  indexOf(el) {\n    if (el instanceof ZxEditorQuery) el = el[0]\n    for (let i = 0; i < this.length; i++) {\n      if (this[i] === el) return i\n    }\n    return -1\n  },\n\n  /**\n   * this is in $parent children\n   * @param $parent\n   * @return {boolean}\n   */\n  isInChild ($parent) {\n    let el = this[0]\n    let $child = $parent.children()\n    let $item\n    for (let i = 0; i < $child.length; i++) {\n      $item = $($child[i])\n      if ($item.is(el)) {\n        return true\n      }\n      if ($item.children().length && this.isInChild($item)) {\n        return true\n      }\n    }\n    return false\n  },\n\n  /**\n   * every\n   * @param fn\n   * @return {boolean}\n   */\n  every (fn) {\n    if (typeof fn !== 'function') throw new TypeError(`every(fn) fn is not a function`)\n    let len = this.length\n    let thisArg = arguments.length >= 2 ? arguments[1] : void 0\n    for (let i = 0; i < len; i++) {\n      if (fn.call(thisArg, $(this[i]), i)) return false\n    }\n    return true\n  },\n  /**\n   * ********************************************\n   * content\n   * ********************************************\n   */\n  text (text) {\n    if (typeof text === 'undefined') {\n      if (this[0]) {\n        return this[0].textContent.trim()\n      }\n      return ''\n    }\n\n    for (let i = 0; i < this.length; i++) {\n      this[i].textContent = text\n    }\n    return this\n  },\n  html (html) {\n    if (typeof html === 'undefined') {\n      return this[0] ? this[0].innerHTML : ''\n    }\n\n    for (let i = 0; i < this.length; i++) {\n      this[i].innerHTML = html\n    }\n    return this\n  },\n  /**\n   * ********************************************\n   * node\n   * ********************************************\n   */\n  nodeName () {\n    return this[0] ? this[0].nodeName.toLowerCase() : null\n  },\n  // https://developer.mozilla.org/en-US/docs/Web/API/Node/nodeType\n  nodeType () {\n    return this[0] ? this[0].nodeType : 0\n  },\n  changeNodeName (nodeName) {\n    for (let i = 0; i < this.length; i++) {\n      // change nodeName\n      this[i] = changeNodeName(this[i], nodeName)\n    }\n    return this\n  },\n  /**\n   * ********************************************\n   * visible\n   * ********************************************\n   */\n  hide () {\n    for (let i = 0; i < this.length; i++) {\n      this[i].style.display = 'none'\n    }\n    return this\n  },\n  show () {\n    for (let i = 0; i < this.length; i++) {\n      const el = this[i]\n      if (el.style.display === 'none') {\n        el.style.display = ''\n      }\n      if (window.getComputedStyle(el, null).getPropertyValue('display') === 'none') {\n        // Still not visible\n        el.style.display = 'block'\n      }\n    }\n    return this\n  },\n  /**\n   * ********************************************\n   * Events\n   * ********************************************\n   */\n  on (...args) {\n    let [eventType, fn, useCapture] = args\n    let el\n    for (let i = 0; i < this.length; i++) {\n      el = this[i]\n      if (el.nodeType === 1 || el === document || el === window) {\n        addEventListener(el, eventType, fn, useCapture)\n      }\n    }\n    return this\n  },\n  off(...args) {\n    let [eventType, fn, useCapture] = args\n    let el\n    for (let i = 0; i < this.length; i++) {\n      el = this[i]\n      if (el.nodeType === 1 || el === document || el === window) {\n        removeEventListener(el, eventType, fn, useCapture)\n      }\n    }\n    return this;\n  },\n  trigger(...args) {\n    const events = args[0].split(' ')\n    const eventData = args[1]\n    for (let i = 0; i < events.length; i++) {\n      const event = events[i]\n      for (let j = 0; j < this.length; j++) {\n        const el = this[j]\n        let evt\n        try {\n          evt = new window.CustomEvent(event, {\n            detail: eventData,\n            bubbles: true,\n            cancelable: true,\n          })\n        } catch (e) {\n          evt = document.createEvent('Event')\n          evt.initEvent(event, true, true)\n          evt.detail = eventData\n        }\n        el.dispatchEvent(evt)\n      }\n    }\n    return this\n  },\n  /**\n   * ********************************************\n   * css\n   * ********************************************\n   */\n  css(props, value) {\n    let i\n    if (arguments.length === 1) {\n      if (typeof props === 'string') {\n        if (this[0]) return window.getComputedStyle(this[0], null).getPropertyValue(props)\n        return void 0\n      } else {\n        for (i = 0; i < this.length; i += 1) {\n          for (let prop in props) {\n            this[i].style[prop] = props[prop]\n          }\n        }\n      }\n    }\n    if (arguments.length === 2 && typeof props === 'string') {\n      for (i = 0; i < this.length; i += 1) {\n        this[i].style[props] = value;\n      }\n    }\n    return this\n  },\n  styles() {\n    if (this[0]) return window.getComputedStyle(this[0], null)\n    return {}\n  },\n  /**\n   * ********************************************\n   * size\n   * ********************************************\n   */\n  width() {\n    if (this[0] === window) return window.innerWidth\n    return this.length > 0 ? parseFloat(this.css('width')) : null\n  },\n  outerWidth(includeMargins) {\n    if (this.length > 0) {\n      let offsetWidth = this[0].offsetWidth\n      if (includeMargins) {\n        const styles = this.styles()\n        return offsetWidth + parseFloat(styles.getPropertyValue('margin-right')) + parseFloat(styles.getPropertyValue('margin-left'))\n      }\n      return offsetWidth\n    }\n    return null\n  },\n  height() {\n    if (this[0] === window) return window.innerHeight\n    return this.length > 0 ? parseFloat(this.css('height')) : null\n  },\n  outerHeight(includeMargins) {\n    if (this.length > 0) {\n      let offsetHeight = this[0].offsetHeight\n      if (includeMargins) {\n        let styles = this.styles()\n        return offsetHeight + parseFloat(styles.getPropertyValue('margin-top')) + parseFloat(styles.getPropertyValue('margin-bottom'))\n      }\n      return offsetHeight\n    }\n    return null\n  },\n  offset() {\n    if (this.length > 0) {\n      const el = this[0];\n      let box = el.getBoundingClientRect()\n      const body = document.body\n      const clientTop = el.clientTop || body.clientTop || 0\n      const clientLeft = el.clientLeft || body.clientLeft || 0\n      const scrollTop = el === window ? window.scrollY : el.scrollTop\n      const scrollLeft = el === window ? window.scrollX : el.scrollLeft\n      return {\n        top: (box.top + scrollTop) - clientTop,\n        left: (box.left + scrollLeft) - clientLeft,\n      }\n    }\n    return null\n  }\n}\n\nconst $ = function (selector, context) {\n  return new ZxEditorQuery(selector, context)\n}\n\nexport default $\n","/**\n * Created by Capricorncd.\n * Date: 2019/04/15 13:14\n * Copyright © 2017-present, https://github.com/capricorncd\n */\nimport $, { ZxEditorQuery } from '../dom-class/index'\n\n/**\n * Cursor Class\n * @param $parent\n * @constructor\n */\nfunction CursorClass ($parent) {\n  // Limit focus range\n  this.$parent = $parent\n  this.selection = null\n  this.range = null\n  this.currentNode = null\n  this.timer = null\n  let $el = $parent.lastChild()\n  // init offset\n  this.offset = $el.text().length || 0\n  if ($el[0]) this.setRange($el[0], this.offset)\n}\n\n/**\n * prototype\n * @type {{constructor: CursorClass, init(*=): void, setRange(*=, *=): void, getRange(): *}}\n */\nCursorClass.prototype = {\n  /**\n   * constructor\n   */\n  constructor: CursorClass,\n\n  init () {\n    this.selection = window.getSelection()\n    try {\n      this.range = this.selection.getRangeAt(0)\n    } catch (e) {\n      this.range = new Range()\n    }\n  },\n\n  /**\n   * 设置或创建光标位置\n   * @param el\n   * @param offset\n   */\n  setRange (el, offset) {\n    if (el instanceof ZxEditorQuery) {\n      el = el[0]\n    }\n    // check offset\n    if (typeof offset === 'number') {\n      this.offset = offset\n    }\n    // check arguments\n    if (typeof el === 'number' && typeof offset === 'undefined') {\n      this.offset = el\n      el = null\n    }\n    if (this.selection === null) {\n      this.init()\n    } else {\n      // remove all range object\n      this.selection.removeAllRanges()\n    }\n    // 光标移动到到原来的位置加上新内容的长度\n    if (el) {\n      this.range.setStart(el, this.offset)\n      this.currentNode = el\n    }\n    // cursor start and end position is collapse\n    this.range.collapse(true)\n\n    if (this.timer) {\n      clearTimeout(this.timer)\n      this.timer = null\n    }\n    // 延时执行，键盘自动收起后再触发focus\n    this.timer = setTimeout(() => {\n      // 插入新的光标对象\n      this.selection.addRange(this.range)\n    }, 100)\n  },\n\n  /**\n   * 获取光标及当前光标所在的DOM元素节点\n   * @returns {*} $rangeElm\n   */\n  getCurrentNode () {\n    // 获取选定对象\n    this.selection = window.getSelection()\n    // 设置最后光标对象\n    try {\n      this.range = this.selection.getRangeAt(0)\n    } catch (e) {\n      this.range = new Range()\n    }\n    this.currentNode = this.range.endContainer\n    this.offset = this.range.startOffset\n    // Check whether currentNode is in the this.$parent\n    return $(this.currentNode).isInChild(this.$parent) ? $(this.currentNode) : this.$parent.lastChild()\n  }\n}\n\nexport default CursorClass\n","/**\n * Created by Capricorncd.\n * User: https://github.com/capricorncd\n * Date: 2019/04/21 22:42\n */\nimport $ from '../dom-class'\nimport util from '../util'\nimport ZxEditor from '../index'\n\nconst DEF_OPTS = {\n  head: null,\n  // className\n  className: '',\n  // head setup\n  headHeight: 44,\n  headTitle: 'Expansion Panel',\n  // height\n  height: 260,\n  // body内容\n  body: null,\n  // Used to distinguish ExpansionPanel instance\n  name: 'expansion-panel'\n}\n\n/**\n * ExpansionPanel\n * Extension panel fixed at the bottom of the editor\n * @param options\n * @param zxEditor ZxEditor instance\n * @constructor\n */\nfunction ExpansionPanel (options, zxEditor) {\n  if (!zxEditor instanceof ZxEditor) {\n    throw new TypeError(`new ExpansionPanel() parameter error, arguments[1] is no a ZxEditor instance.`)\n  }\n\n  // options\n  let opts = this.options = Object.assign({}, DEF_OPTS, options)\n\n  // editor instance\n  this.editorInstance = zxEditor\n\n  zxEditor.expansionPanels.push(this)\n\n  // visible\n  this.visible = false\n\n  // Used to distinguish ExpansionPanel instance\n  this.name = util.toHump(opts.name)\n\n  this.$head = $(`<div class=\"head-wrapper border-bottom\" style=\"height:${opts.headHeight}px;line-height:${opts.headHeight}px;\">${opts.headTitle || ''}</div>`)\n\n  this.$body = $(`<div class=\"body-wrapper\" style=\"height:${opts.height - opts.headHeight}px;\"></div>`)\n\n  // node\n  this.$el = $(`<div class=\"zx-editor-expansion-panel border-top out\"></div>`)\n\n  if (opts.headHeight > 0) {\n    // custom head\n    if (opts.head) {\n      this.$head = $(opts.head)\n    } else {\n      const $switch = $(`<i class=\"switch\" style=\"width:${opts.headHeight}px;height:${opts.headHeight}px;\"></i>`)\n      this.$head.append($switch)\n      // switch event\n      zxEditor.$eventHandlers[this.name] = {\n        $target: $switch,\n        type: 'click',\n        handler: () => {\n          this.hide()\n        }\n      }\n      $switch.on('click', zxEditor.$eventHandlers[this.name].handler)\n    }\n\n    this.$el.append(this.$head)\n  }\n\n  // body\n  try {\n    this.$body.append($(opts.body))\n  } catch (e) {\n    throw e\n  }\n\n  this.$el.append(this.$body)\n\n  // append to $editor\n  zxEditor.$editor.append(this.$el)\n\n  // init\n  this.init(this.options)\n}\n\nExpansionPanel.prototype = {\n  /**\n   * constructor\n   */\n  constructor: ExpansionPanel,\n\n  /**\n   * init position\n   * Used to window.onresize\n   * @param options\n   */\n  init (options) {\n    options = options || this.options\n    let winHeight = window.innerHeight\n    this.$el.css({\n      height: `${options.height}px`,\n      top: winHeight - options.height + 'px'\n    })\n  },\n\n  /**\n   * show\n   */\n  show () {\n    if (!this.visible) {\n      this.$el.removeClass('out').addClass('in')\n      this.visible = true\n      this.editorInstance.emit('expansionPanelShow', this, this.editorInstance)\n    }\n  },\n\n  /**\n   * hide\n   */\n  hide () {\n    if (this.visible) {\n      this.$el.removeClass('in').addClass('out')\n      this.visible = false\n      this.editorInstance.emit('expansionPanelHide', this, this.editorInstance)\n    }\n  }\n}\n\nexport default ExpansionPanel\n","/**\n * Created by Capricorncd.\n * User: https://github.com/capricorncd\n * Date: 2019/04/15 21:52\n */\nimport util from '../util'\n\n/**\n * 获取剪切文本内容\n * @param e event\n * @return {Promise<any>}\n */\nexport function getPasteText (e) {\n  return new Promise(resolve => {\n    let clipboardData = e.clipboardData\n    let pasteStr = ''\n    if (!clipboardData) {\n      resolve('')\n      return\n    }\n    let items = clipboardData.items\n    // console.log(e)\n    // console.log(clipboardData)\n    // console.log(items)\n    if (items && items.length > 0) {\n      let len = items.length\n      let count = 0\n      let i, item\n      for (i = 0; i < len; i++) {\n        item = items[i]\n        // 获取文本内容\n        if (/^text\\/plain/.test(item.type)) {\n          item.getAsString(str => {\n            pasteStr += str\n            counter(count, len)\n          })\n        } else {\n          counter(count, len)\n        }\n      }\n    } else {\n      resolve('')\n    }\n\n    /**\n     * 计数\n     * @param count\n     * @param len\n     */\n    function counter(count, len) {\n      count++\n      if (count === len) resolve(util.strip(pasteStr))\n    }\n  })\n}\n","/**\n * Created by Capricorncd.\n * User: https://github.com/capricorncd\n * Date: 2019/04/15 21:53\n */\nimport $ from '../dom-class'\nimport {\n  windowResize,\n  contentPaste,\n  contentInput,\n  contentFocus,\n  contentBlur\n} from '../events/handlers'\n\nexport function handleEvents () {\n  /**\n   * content paste\n   */\n  this.$eventHandlers.contentPaste = {\n    $target: this.$content,\n    type: 'paste',\n    handler: contentPaste.bind(this)\n  }\n\n  /**\n   * window resize\n   */\n  this.$eventHandlers.windowResize = {\n    $target: $(window),\n    type: 'resize',\n    handler: windowResize.bind(this)\n  }\n\n  /**\n   * content input\n   */\n  this.$eventHandlers.contentInput = {\n    $target: this.$content,\n    type: 'input',\n    handler: contentInput.bind(this)\n  }\n\n  this.$eventHandlers.contentFocus = {\n    $target: this.$content,\n    type: 'focus',\n    handler: contentFocus.bind(this)\n  }\n\n  this.$eventHandlers.contentBlur = {\n    $target: this.$content,\n    type: 'blur',\n    handler: contentBlur.bind(this)\n  }\n\n  /**\n   * register events\n   */\n  let evt\n  for (let key in this.$eventHandlers) {\n    evt = this.$eventHandlers[key]\n    evt.$target.on(evt.type, evt.handler, evt.capture)\n  }\n}\n","/**\n * Created by Capricorncd.\n * User: https://github.com/capricorncd\n * Date: 2019/04/21 14:57\n */\nimport util from '../util'\nimport { getPasteText } from './paste'\n\n/**\n * window onResize handler\n */\nexport function windowResize () {\n  this.toolbar.init()\n  this.emit('windowResize', this)\n}\n\n/**\n * content onPaste\n * @param e\n */\nexport function contentPaste (e) {\n  e.preventDefault()\n  getPasteText(e).then(str => {\n    // 添加至焦点处\n    this.insertElm(util.removeHtmlTags(str))\n  })\n}\n\n/**\n * content input\n */\nexport function contentInput () {\n  this._checkEmpty()\n  this.emit('contentChange', this)\n}\n\n/**\n * content on focus\n */\nexport function contentFocus () {\n  // console.error('contentFocus')\n  // hide all expansionPanels\n  // this.expansionPanels.forEach(ep => {\n  //   ep.hide()\n  // })\n  // toolbar\n  if (!this.options.toolbarBeenFixed) {\n    this.toolbar.show()\n  }\n}\n\n/**\n * content on blur\n */\nexport function contentBlur () {\n  // toolbar\n  if (!this.options.toolbarBeenFixed) {\n    this.toolbar.hide()\n  }\n}\n","/**\n * Create by capricorncd\n * 2018/5/30 0030.\n */\n/**\n * on\n * @param notifyName\n * @param fn\n */\nfunction on (notifyName, fn) {\n  if (!notifyName\n    || typeof notifyName !== 'string'\n    || !fn\n    || typeof fn !== 'function') return\n  if (!this.customEvents[notifyName]) {\n    this.customEvents[notifyName] = []\n  }\n  this.customEvents[notifyName].push(fn)\n}\n\n/**\n * emit\n * @param notifyName\n */\nfunction emit (notifyName) {\n  let notifyArr = this.customEvents[notifyName]\n  if (!notifyArr) return\n  let args = Array.prototype.slice.call(arguments, 1)\n  for (let i = 0; i < notifyArr.length; i++) {\n    try {\n      notifyArr[i].apply(null, args)\n    } catch (e) {\n      this.emit('error', e)\n    }\n  }\n}\n\n/**\n * off\n * @param notifyName\n */\nfunction off (notifyName, fn) {\n  if (this.customEvents[notifyName]) {\n    if (typeof fn === 'function' && this.customEvents[notifyName]) {\n      let index = this.customEvents[notifyName].findIndex(item => item === fn)\n      if (index >= 0) this.customEvents[notifyName].splice(index, 1)\n    } else {\n      this.customEvents[notifyName] = null\n      delete this.customEvents[notifyName]\n    }\n  }\n}\n\nexport {\n  on,\n  emit,\n  off\n}\n","/**\n * Created by Capricorncd.\n * User: https://github.com/capricorncd\n * Date: 2019/04/24 21:37\n */\nimport { document } from 'ssr-window'\nimport util from \"../util\";\n\nexport function getImageInfo (base64, file, orientation, callback) {\n  let img = new Image()\n  img.src = base64\n  img.setAttribute('alt', file.name)\n  // 加载图片\n  img.onload = function () {\n    callback(null, orientation > 1 ? rotateAndToBase64(img, orientation, file.type) : {\n      element: img,\n      base64,\n      width: img.width,\n      height: img.height,\n      file\n    })\n  }\n\n  img.onerror = function (e) {\n    callback(e)\n  }\n}\n\n/**\n * Decide whether the picture is rotated or not according to 'opts.orientation' value\n * @param img\n * @param type\n * @returns {Object}\n */\nfunction rotateAndToBase64 (img, orientation, type) {\n  let canvas = document.createElement('canvas')\n  let ctx = canvas.getContext('2d')\n  let imgWidth = img.width\n  let imgHeight = img.height\n  canvas.width = imgWidth\n  canvas.height = imgHeight\n  // rotate image\n  switch(orientation) {\n    // 90deg\n    case 6:\n      canvas.width = imgHeight\n      canvas.height = imgWidth\n      ctx.rotate(Math.PI / 2)\n      // (0, -imgHeight)\n      ctx.drawImage(img, 0, -imgHeight, imgWidth, imgHeight)\n      break\n    // 180deg\n    case 3:\n      ctx.rotate(Math.PI)\n      ctx.drawImage(img, -imgWidth, -imgHeight, imgWidth, imgHeight)\n      break;\n    // -90(270)deg\n    case 8:\n      canvas.width = imgHeight\n      canvas.height = imgWidth\n      ctx.rotate(3 * Math.PI / 2)\n      ctx.drawImage(img, -imgWidth, 0, imgWidth, imgHeight)\n      break\n    default:\n      ctx.drawImage(img, 0, 0, imgWidth, imgHeight)\n  }\n  let base64 = canvas.toDataURL(opts.type)\n  img.src = base64\n  let result = {\n    element: img,\n    base64,\n    width: canvas.width,\n    height: canvas.height\n  }\n  canvas = null\n  return result\n}\n\n/**\n * 创建Canvas\n * @param $el Image object or Canvas element\n * @param p clip options\n * @returns {Element}\n */\nexport function createCanvas ($el, p) {\n  const canvas = document.createElement('canvas')\n  canvas.width = p.cw\n  canvas.height = p.ch\n  const ctx = canvas.getContext('2d')\n  ctx.drawImage($el, p.sx, p.sy, p.sw, p.sh, 0, 0, canvas.width, canvas.height)\n  return canvas\n}\n\n/**\n * 缩放比列\n * @param {Number} numerator\n * @param {Number} denominator\n */\nfunction ratio (numerator, denominator) {\n  return parseInt(numerator / denominator * 10000) / 10000\n}\n\n/**\n * Calculate the position and size of the generated image clipping\n * @param {Number} iw // image width\n * @param {Number} ih // image height\n * @param {Object} opts\n */\nexport function computeCropInfo (iw, ih, opts) {\n  // target image width, height\n  let targetWidth = util.int(opts.width)\n  let targetHeight = util.int(opts.height)\n\n  // image width or height, less than target width or height\n  // don't resize\n  if (!opts.forceResize && (targetWidth > 0 && iw < targetWidth)\n    && (targetHeight > 0 && ih < targetHeight)) {\n    return {\n      sx: 0,\n      sy: 0,\n      sw: iw,\n      sh: ih,\n      scaling: 1,\n      cw: iw,\n      ch: ih\n    }\n  }\n\n  // scaling\n  let scaling = 1\n\n  // Pictures begin to crop in x, y coordinates\n  let sx = 0\n  let sy = 0\n  // canvas\n  let canvasWidth = iw\n  let canvasHieght = ih\n  // Picture Size after Equal Ratio Scaling\n  let sw = 0\n  let sh = 0\n\n  // Scale to the right size, then cut in the middle\n  if (targetWidth > 0 && targetHeight > 0) {\n    // The size of canvas is to set the size for cutting\n    canvasWidth = targetWidth\n    canvasHieght = targetHeight\n\n    // Adjust the size of the picture according to the target width: the width of the picture equals the width of the clipping frame\n    sw = targetWidth\n    sh = Math.floor(targetWidth * ih / iw)\n\n    scaling = ratio(iw, targetWidth)\n\n    // Picture height beyond the clipping box, can be normal clipping\n    if (sh >= targetHeight) {\n      sx = 0\n      sy = util.int((sh - targetHeight) / 2 * scaling)\n    }\n    // To satisfy the clipping requirement, we need to resize: image height === clipping frame height\n    else {\n      scaling = ratio(ih, targetHeight)\n      sw = Math.floor(targetHeight * iw / ih)\n      sh = targetHeight\n      sx = util.int((sw - targetWidth) / 2 * scaling)\n      sy = 0\n    }\n\n  }\n  // Zoom Picture Code **********************************\n  // Only width is set\n  else if (targetWidth > 0) {\n    scaling = ratio(iw, targetWidth)\n    canvasWidth = targetWidth\n    canvasHieght = Math.floor(targetWidth * ih / iw)\n  }\n  // Only height is set\n  else if (targetHeight > 0) {\n    scaling = ratio(ih, targetHeight)\n    canvasWidth = Math.floor(targetHeight * iw / ih)\n    canvasHieght = targetHeight\n  }\n\n  return {\n    sx: sx,\n    sy: sy,\n    sw: util.int(canvasWidth * scaling),\n    sh: util.int(canvasHieght * scaling),\n    scaling: scaling,\n    cw: canvasWidth,\n    ch: canvasHieght\n  }\n}\n","/**\n * Created by Capricorncd.\n * User: https://github.com/capricorncd\n * Date: 2019/04/24 21:13\n */\nimport { window } from 'ssr-window'\nimport { getImageInfo, computeCropInfo, createCanvas } from './helper'\n\nconst DEF_OPTIONS = {\n  imageMaxSize: null,\n  ignoreGif: true,\n  forceResize: false\n}\n\n/**\n * base64 data to Blob\n * @param base64Data\n * @return {Blob}\n */\nfunction base64ToBlobData (base64Data) {\n  // base64数据格式:\n  // \"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/2wBDAAkGB+wgHBgkIBwgKCgkLDRYPDQw//9k=\"\n  let type, onlyData\n  if (/^data:(\\w+\\/\\w+);base64,(.+)/.test(base64Data)) {\n    type = RegExp.$1\n    onlyData = RegExp.$2\n  } else {\n    throw new TypeError(`base64ToBlobData(base64Data), base64Data non-base64 data!`)\n  }\n\n  let data = window.atob(onlyData)\n  let ia = new Uint8Array(data.length)\n  for (let i = 0; i < data.length; i++) {\n    ia[i] = data.charCodeAt(i)\n  }\n  return new Blob([ia], {type: type})\n}\n\n/**\n * file to base64 data\n * @param file\n * @param opts\n * @return {Promise<any>}\n */\nfunction fileToBase64 (file, opts) {\n  return new Promise((resolve, reject) => {\n    if (!file || !file instanceof File) {\n      throw new TypeError(`file is not a File object`)\n    }\n\n    if (this.options) {\n      opts = Object.assign({}, DEF_OPTIONS, opts)\n    }\n\n    // check file type\n    if (!/image\\/.*/.test(file.type)) {\n      reject(new TypeError(`\"${file.name}\" is not Image File!`))\n      return\n    }\n\n    // roate image\n    if (typeof window.EXIF === 'undefined') {\n      opts.orientation = 0\n      handleFile(file, opts).then(resolve).catch(reject)\n    } else {\n      window.EXIF.getData(file, function () {\n        let info = window.EXIF.getAllTags(this) || {}\n        // Shooting direction\n        opts.orientation = info.Orientation\n        handleFile(file, opts).then(resolve).catch(reject)\n      })\n    }\n  })\n}\n\n/**\n * to blob url\n * @param blob Blob数据\n * @returns {*}\n */\nfunction blobToUrl (blob) {\n  return window.URL.createObjectURL(blob)\n}\n\nfunction handleFile (file, opts) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader()\n    reader.readAsDataURL(file)\n    reader.onload = function () {\n      // get image info\n      getImageInfo(this.result, file, opts.orientation, (e, res) => {\n        if (e) {\n          reject(e)\n          return\n        }\n        // check gif\n        if (file.type === 'image/gif' && opts.ignoreGif) {\n          resolve({\n            ...res,\n            type: file.type,\n            size: file.size,\n            name: file.name\n          })\n          return\n        }\n        let result = handleImageData(res, opts)\n        // check file size\n        if (opts.imageMaxSize > 0 && result.size / 1024 > opts.imageMaxSize) {\n          reject(new RangeError(`File size \"${result.size / 1024}\" out of range, limit is ${opts.imageMaxSize}Kib`))\n          return\n        }\n        resolve(result)\n      })\n    }\n\n    reader.onerror = reject\n  })\n}\n\n/**\n * Processing picture data, clipping and compression\n * @param imageInfo\n * @param opts\n * @private\n */\nfunction handleImageData (imageInfo, opts) {\n  // file type\n  let dataType = imageInfo.file.type\n\n  // Calculate the position and size of zooming or clipping pictures\n  let res = computeCropInfo(imageInfo.width, imageInfo.height, opts)\n\n  // image\n  let el = imageInfo.element\n\n  let scaling = 2\n  let sw = res.sw\n  let sh = res.sh\n  let sx = res.sx\n  let sy = res.sy\n\n  if (res.scaling > scaling) {\n    scaling = res.scaling\n    do {\n      el = createCanvas(el, {\n        cw: res.cw * scaling,\n        ch: res.ch * scaling,\n        sx: sx,\n        sy: sy,\n        sw: sw,\n        sh: sh\n      })\n      sw = el.width\n      sh = el.height\n      sx = sy = 0\n      scaling -= 1\n    } while (scaling > 2)\n  }\n  el = createCanvas(el, {\n    cw: res.cw,\n    ch: res.ch,\n    sx: sx,\n    sy: sy,\n    sw: sw,\n    sh: sh\n  })\n\n  let base64 = el.toDataURL(dataType)\n  let blob = base64ToBlobData(base64)\n\n  return {\n    element: el,\n    type: dataType,\n    width: res.cw,\n    height: res.ch,\n    data: blob,\n    base64: base64,\n    size: blob.size,\n    url: blobToUrl(blob),\n    // 原始图片数据\n    rawData: imageInfo\n  }\n}\n\nexport {\n  fileToBase64,\n  blobToUrl,\n  base64ToBlobData\n}\n","/**\n * Created by Capricorncd.\n * User: https://github.com/capricorncd\n * Date: 2019/04/21 10:33\n */\nexport const IPHONEX_BOTTOM_OFFSET_HEIGHT = 200\n","/**\n * Created by Capricorncd.\n * User: https://github.com/capricorncd\n * Date: 2019/04/21 10:25\n */\nimport $ from '../dom-class'\nimport util from '../util'\nimport { window } from 'ssr-window'\nimport { IPHONEX_BOTTOM_OFFSET_HEIGHT } from '../config'\n\n// default button options\nconst DEF_BTN_OPTS = {\n  name: '',\n  // button className\n  className: '',\n  // ElementHTML or $()\n  el: null,\n  // innerHTML\n  innerHtml: '',\n  // style\n  style: '',\n  // obj{type: 'click', handler: fn, capture: false} or array[obj1, obj2]\n  events: null\n}\n\nfunction Toolbar (options, zxEditor) {\n  // zxEditor instance\n  this.editorInstance = zxEditor\n\n  // options\n  this.options = options\n\n  // visible\n  this.visible = options.toolbarBeenFixed\n\n  // create element\n  this.height = options.toolbarHeight\n  this.$el = $(`<div class=\"zx-editor-toolbar-wrapper border-top ${this.visible ? 'in' : 'out'}\" style=\"height:${this.height + IPHONEX_BOTTOM_OFFSET_HEIGHT}px;\"><dl class=\"inner-wrapper\" style=\"height:${this.height}px;\"></dl></div>`)\n\n  // append to $editor\n  zxEditor.$editor.append(this.$el)\n\n  // init\n  this.init(options)\n}\n\nToolbar.prototype = {\n  /**\n   * constructor\n   */\n  constructor: Toolbar,\n\n  /**\n   * Used to window.onresize\n   * @param options\n   */\n  init (options) {\n    options = options || this.options\n    let winHeight = window.innerHeight\n    this.$el.css({\n      top: winHeight - options.toolbarHeight + 'px'\n    })\n    if (this.visible) this.editorInstance.emit('toolbarShow', this, this.editorInstance)\n  },\n\n  /**\n   * show\n   */\n  show () {\n    if (!this.visible) {\n      // change className\n      this.$el.removeClass('out').addClass('in')\n      this.visible = true\n      this.editorInstance.emit('toolbarShow', this, this.editorInstance)\n    }\n  },\n\n  /**\n   * hide\n   */\n  hide () {\n    if (this.visible) {\n      // change className\n      this.$el.removeClass('in').addClass('out')\n      this.visible = false\n      this.editorInstance.emit('toolbarHide', this, this.editorInstance)\n    }\n  },\n\n  /**\n   * add button\n   * @param opts\n   * @param index Insert index\n   */\n  addButton (opts, index) {\n    // params\n    let params = Object.assign({}, DEF_BTN_OPTS, opts)\n\n    // name\n    if (!params.name) params.name = 'toolbar-btn-' + (+new Date())\n\n    // create $node\n    let $btn = $(`<dd class=\"icon-item\" data-name=\"${params.name}\" style=\"${params.style}\"></dd>`)\n    // handle el\n    if (params.el && typeof params.el === 'object') {\n      $btn.append($(params.el))\n    } else {\n      // handle innerHtml\n      $btn.html(params.innerHtml)\n    }\n\n    // className\n    if (params.className) {\n      $btn.addClass(params.className)\n    }\n\n    // style\n    let css = {}\n    if (this.options.toolbarHeight) {\n      css.width = css.height = this.options.toolbarHeight + 'px'\n    }\n    $btn.css(css)\n\n    // insert to document\n    let $btns = this.$el.find('.inner-wrapper').children()\n\n    if (typeof index === 'number' && index < $btns.length) {\n      $btn.insertBefore($btns[index])\n    } else {\n      this.$el.find('.inner-wrapper').append($btn)\n    }\n\n    // events\n    if (params.events) {\n      let events\n      if (util.isObject(params.events)) {\n        events = []\n        events.push(params.events)\n      } else if (Array.isArray(params.events)) {\n        events = params.events\n      }\n      // register events\n      let eventHandlerKey\n      const $eventHandlers = this.editorInstance.$eventHandlers\n      events.forEach(item => {\n        if (item && typeof item.type === 'string' && typeof item.handler === 'function') {\n          eventHandlerKey = `toolbarBtnEvent_${item.name}`\n          $eventHandlers[eventHandlerKey] = {\n            $target: $btn,\n            type: item.type,\n            handler: item.handler.bind(this.editorInstance),\n            capture: typeof item.capture === 'boolean' ? item.capture : false\n          }\n          $btn.on(item.type, $eventHandlers[eventHandlerKey].handler, $eventHandlers[eventHandlerKey].capture)\n        } else {\n          throw new TypeError(`Function addButton(opts), opts.events's parameter error.`)\n        }\n      })\n    }\n  }\n}\n\nexport default Toolbar\n","/**\n * Created by Capricorncd.\n * User: https://github.com/capricorncd\n * Date: 2019/04/27 21:11\n */\nimport ExpansionPanel from '../expansion-panel/index'\nimport $ from '../dom-class'\n\n// COLOR\nconst DEF_COLORS = {\n  black: '#333',\n  gray: '#d0d0d0',\n  red: '#ff583d',\n  yellow: '#fdaa25',\n  green: '#44c67b',\n  blue: '#14b2e0',\n  purple: '#b065e2'\n}\n\nexport function styleExpansionPanel (options) {\n\n  const COLORS = Object.assign({}, DEF_COLORS, options.textStyleColors)\n\n  let styleWrapper = `<dl class=\"__style-wrapper border-bottom\"><dd class=\"text-bold\" data-style=\"fontWeight:800\">B</dd><dd class=\"text-italic\" data-style=\"fontStyle:italic\">I</dd><dd class=\"through-line\" data-style=\"textDecoration:line-through\">abc</dd></dl>`\n  let colorWrapper = `<dl class=\"__color-wrapper border-bottom\"><dd class=\"active __black\" data-color=\"\"></dd><dd class=\"__gray\" data-color=\"${COLORS.gray}\"></dd><dd class=\"__red\" data-color=\"${COLORS.red}\"></dd><dd class=\"__yellow\" data-color=\"${COLORS.yellow}\"></dd><dd class=\"__green\" data-color=\"${COLORS.green}\"></dd><dd class=\"__blue\" data-color=\"${COLORS.blue}\"></dd><dd class=\"__purple\" data-color=\"${COLORS.purple}\"></dd></dl>`\n  let tagWrapper = `<dl class=\"__tag-wrapper\"><dd class=\"__h2\" data-tag=\"h2\">大标题<i></i></dd><dd class=\"__h4\" data-tag=\"h4\">小标题<i></i></dd><dd class=\"__p\" data-tag=\"p\">正文<i class=\"checked\"></i></dd><dd class=\"__blockquote\" data-tag=\"blockquote\"><b></b>引用<i></i></dd><dd class=\"__ul\" data-tag=\"ul\"><b></b>无序列表<i></i></dd></dl>`\n\n  let panelBody = `<div class=\"text-style-outer-wrapper\">${styleWrapper + colorWrapper + tagWrapper}</div>`\n\n  // text style\n  let textStylePanelParams = {\n    headTitle: 'Text Style',\n    body: $(panelBody)\n  }\n  this.textStylePanel = new ExpansionPanel(textStylePanelParams, this)\n\n  // handle events\n  // ...\n\n  return {\n    name: 'text-style',\n    className: 'text-style-btn',\n    events: {\n      type: 'click',\n      handler: () => {\n        this.textStylePanel.show()\n      }\n    }\n  }\n}\n","/**\n * Created by Capricorncd.\n * User: https://github.com/capricorncd\n * Date: 2019/04/23 22:44\n */\nimport Toolbar from '../toolbar/index'\nimport { selectPictureBtn } from './select-picture-btn'\nimport { styleExpansionPanel } from './style-expansion-panel'\n\nexport function initToolbar (options) {\n  const _this = this\n  // toolbar\n  this.toolbar = new Toolbar(options, this)\n\n  // Add buttons sequentially\n  options.toolbarBtns.forEach(name => {\n    if (name === 'select-picture') {\n      this.toolbar.addButton(selectPictureBtn.call(this, options))\n    } else if (name === 'text-style') {\n      this.toolbar.addButton(styleExpansionPanel.call(this, options))\n    }\n  })\n}\n","/**\n * Created by Capricorncd.\n * User: https://github.com/capricorncd\n * Date: 2019/04/27 21:19\n */\nimport $ from '../dom-class/index'\n\nexport function selectPictureBtn (options) {\n  const _this = this\n  /**\n   * *******************************************\n   * select picture\n   * image file handler\n   * *******************************************\n   */\n    // select picture\n  let $selectPictureLabel = $('<label class=\"toolbar-icon-pic\" style=\"position:absolute;top:0;left:0;width:100%;height:100%;\"></label>')\n  let $selectPictrueInput = $('<input type=\"file\" accept=\"image/*\" style=\"display:none\">')\n  $selectPictureLabel.append($selectPictrueInput)\n  let input = $selectPictrueInput[0]\n\n  // register selectPictureInputClick\n  this.$eventHandlers['selectPictureInputClick'] = {\n    $target: $selectPictrueInput,\n    type: 'click',\n    handler () {\n      input.value = ''\n    },\n    capture: false\n  }\n\n  // image section template\n  let imageSectionTemplate = /^<section\\b.*<\\/section>$/.test(options.imageSectionTemp) ? options.imageSectionTemp : `<section><img src=\"{url}\"></section>`\n\n  // register selectPictureInputChange\n  let imageOptions = {\n    imageMaxSize: options.imageMaxSize,\n    width: options.imageMaxWidth\n  }\n  this.$eventHandlers['selectPictureInputChange'] = {\n    $target: $selectPictrueInput,\n    type: 'change',\n    handler (e) {\n      let file = input.files[0]\n      _this.emit('selectPictureInputChange', file, e, _this)\n\n      // customize Picture Handler\n      if (options.customizePictureHandler) return\n\n      // handler picture\n      _this.fileToBase64(file, imageOptions).then(res => {\n        let $el = $(imageSectionTemplate.replace('{url}', res.base64))\n        // set attribute\n        $el.find('img').attr({\n          id: 'zxEditor_img_' + (+new Date()),\n          alt: file.name\n        })\n        // insert to $content\n        _this.insertElm($el)\n      }).catch(e => {\n        _this.emit('error', e, 'handlePictureFile')\n      })\n    },\n    capture: false\n  }\n\n  return {\n    name: 'select-picture',\n    el: $selectPictureLabel\n  }\n}\n","/**\n * Created by Capricorncd.\n * Date: 2019/04/12 11:12\n * Copyright © 2017-present, https://github.com/capricorncd\n */\n/**\n * ***********************************************\n * Notes:\n * 1. The property or variables prefixed $ are ZxEditorQuery instance, or related to them\n * ***********************************************\n */\nimport $ from './dom-class/index'\nimport CursorClass from './cursor-class/index'\nimport ExpansionPanel from './expansion-panel/index'\nimport util from './util/index'\nimport { onWatcher } from './init/watcher'\nimport { initDom } from './init/init-dom'\nimport { initStyle } from './init/init-style'\nimport { handleEvents } from './events/index'\nimport { extendPrototypes } from './init/extend-prototype'\nimport { initToolbar } from './init/toolbar'\nimport { base64ToBlobData } from './image-handler/index'\n\nconst DEF_OPTIONS = {\n  // 禁用键盘删除图片、链接等附件\n  disableBackspaceDelete: true,\n  // 内容是否可以被编辑\n  editable: true,\n  // editor height\n  height: null,\n  // fixed editor height\n  fixedHeight: false,\n  // style\n  placeholder: '',\n  placeholderColor: '',\n  lineHeight: 1.5,\n  // paragraph spacing\n  padding: '',\n  cursorColor: '',\n  // Has the toolbar been fixed?\n  toolbarBeenFixed: true,\n  toolbarHeight: 50,\n  toolbarBtns: ['select-picture', 'text-style'],\n  // customize Picture Handler\n  customizePictureHandler: false,\n  // image max width\n  imageMaxWidth: 720,\n  // image max size, unit Kib\n  imageMaxSize: 10240,\n  // template\n  imageSectionTemp: `<section><img src=\"{url}\"></section>`,\n  // text style\n  textStyleColors: {},\n  // border color\n  borderColor: ''\n}\n\nfunction ZxEditor (selector, _options) {\n  if (!this instanceof ZxEditor) {\n    throw new Error('ZxEditor is a constructor and should be called with the `new` keyword')\n  }\n  /**\n   * ***************************************************\n   * check selector\n   * ***************************************************\n   */\n  this.$wrapper = $(selector)\n  if (!this.$wrapper[0]) {\n    throw new Error(`Cann't found '${selector}' Node in document!`)\n  }\n  // version\n  this.version = '__VERSION__'\n  // ZxEditorQuery instance\n  this.$ = $\n  this.ExpansionPanel = ExpansionPanel\n  // options\n  this.options = Object.assign(DEF_OPTIONS, _options)\n  this.init(this.options)\n}\n\nZxEditor.prototype = {\n\n  constructor: ZxEditor,\n\n  init (options) {\n    options = options || this.options\n    /**\n     * ***************************************************\n     * event listeners\n     * or expansionPanel instance\n     * ***************************************************\n     */\n    // $().on, $().off, $().trigger\n    this.$eventHandlers = {}\n    // this.on, this.off, this.emit\n    this.customEvents = {}\n    // extend prototype\n    extendPrototypes(ZxEditor)\n    // watcher\n    onWatcher.call(this)\n    // expansionPanel instance\n    this.expansionPanels = []\n\n    /**\n     * ***************************************************\n     * create dom\n     * ***************************************************\n     */\n    initDom.call(this, options)\n    initToolbar.call(this, options)\n\n    /**\n     * ***************************************************\n     * style and placeholder\n     * ***************************************************\n     */\n    initStyle.call(this, options)\n\n    /**\n     * ***************************************************\n     * cursor\n     * ***************************************************\n     */\n    this.cursor = new CursorClass(this.$content)\n\n    /**\n     * ***************************************************\n     * event: last\n     * ***************************************************\n     */\n    handleEvents.call(this)\n  },\n  /**\n   * 插入元素或字符串\n   * @param el\n   */\n  insertElm (el) {\n    // string\n    if (!el) return\n    // 光标元素及偏移量\n    let $rangeNode = this.cursor.getCurrentNode()\n\n    let newRangeEl, newRangeOffset\n    /**\n     * string\n     */\n    if (typeof el === 'string') {\n      // 光标所在元素内容为空\n      if ($rangeNode.isEmpty()) {\n        $rangeNode.text(el)\n        newRangeEl = $rangeNode[0].childNodes[0]\n        newRangeOffset = el.length\n      } else if ($rangeNode.children().every($item => $item.isTextNode())) {\n        let rangeOffset = this.cursor.offset\n        let rangeNodeStr = $rangeNode.text()\n        let tmpStr = rangeNodeStr.substr(0, rangeOffset) + el + rangeNodeStr.substr(rangeOffset)\n        // $section = $rangeNode.closest('section')\n        $rangeNode.text(tmpStr)\n        newRangeEl = $rangeNode[0].childNodes[0]\n        newRangeOffset = el.length + rangeOffset\n      } else {\n        // 创建一个section\n        let $newEl = $(`<section>${el}</section>`)\n        // 插入到childIndex后\n        $newEl.insertAfter($rangeNode)\n        newRangeEl = $newEl[0].childNodes[0]\n        newRangeOffset = el.length\n      }\n    }\n    /**\n     * 插入元素为：非文本\n     */\n    else {\n      let $el = $(el)\n      let $elm\n      for (let i = 0; i < $el.length; i++) {\n        $elm = $($el[i])\n        let nodeName = $elm.nodeName()\n        // SECTION\n        if (nodeName !== 'section') {\n          if ($elm.nodeType() === 1 && !/video|img|audio/.test(nodeName)) {\n            $elm.changeNodeName('section')\n          } else {\n            let $tmp = $(`<section></section>`)\n            $elm = $tmp.append($elm)\n          }\n        }\n        if ($rangeNode.isEmpty()) {\n          // siblings is empty\n          if ($rangeNode.next()[0] && $rangeNode.next().isEmpty()) {\n            $rangeNode.replace($elm)\n          } else {\n            $elm.insertBefore($rangeNode)\n          }\n        } else {\n          $elm.insertAfter($rangeNode)\n        }\n        // 判断$el是否有下一个节点，有：光标指向el结束，无：则插入空行，并移动光标\n        let next = $elm.next()[0]\n        if (next) {\n          if ($elm.lastChild().isTextNode()) {\n            newRangeEl = $elm.lastChild()[0]\n            newRangeOffset = $elm.lastChild().text().length\n          } else {\n            newRangeEl = $elm[0]\n            newRangeOffset = 1\n          }\n        } else {\n          let $section = $(`<section><br></section>`)\n          this.$content.append($section)\n          newRangeEl = $section[0]\n          newRangeOffset = 0\n        }\n      }\n    }\n    this._checkChildSection()\n    this.$content.trigger('input')\n    this.cursor.setRange(newRangeEl, newRangeOffset)\n  },\n\n  /**\n   * 插入空行\n   */\n  insertBlankLine () {\n    let $el = $(`<section><br></section>`)\n    this.insertElm($el)\n    this.cursor.setRange($el[0], 0)\n  },\n\n  /**\n   * 检查内容是否为空\n   * @private\n   */\n  _checkEmpty () {\n    let $el = this.$content\n    if ($el.isEmpty()) {\n      $el.addClass('is-empty')\n    } else if ($el.hasClass('is-empty')) {\n      $el.removeClass('is-empty')\n    }\n  },\n\n  /**\n   * 检查一级子元素，nodeName是否为section\n   * 否：则替换为setcion标签\n   * @private\n   */\n  _checkChildSection () {\n    const parent = this.$content[0]\n    let childNodes = parent.childNodes\n    let el\n    for (let i = 0; i < childNodes.length; i++) {\n      el = childNodes[i]\n      if (el.nodeType === 1) {\n        if (el.nodeName !== 'SECTION') util.changeNodeName(el, 'section')\n      } else {\n        let $tmp = $(`<section></section>`)\n        $tmp.append(el.cloneNode())\n        parent.replaceChild($tmp[0], el)\n      }\n    }\n  },\n\n  /**\n   * 清空内容\n   */\n  remove () {\n    this.setHtml()\n  },\n\n  /**\n   * 设置编辑器内容\n   * @param html\n   */\n  setHtml (html) {\n    this.$content.html(html || '<section><br></section>')\n    this._checkChildSection()\n    this.cursor.setRange(this.$content.firstChild()[0], 0)\n    this.$content.trigger('input')\n  },\n\n  /**\n   * 获取编辑器html内容\n   * 返回html内容\n   * @return {*}\n   */\n  getHtml () {\n    return this.$content.html()\n  },\n\n  /**\n   * 获取编辑器文本内容，\n   * 以纯文本形式返回数据\n   * @return {*|string}\n   */\n  getText () {\n    return this.$content.text()\n  },\n\n  /**\n   * destroy event and Node\n   */\n  destroy(){\n    let evt\n    // remove $events\n    for (let key in this.$eventHandlers) {\n      evt = this.$eventHandlers[key]\n      evt.$target.off(evt.type, evt.handler, evt.capture)\n      delete this.$eventHandlers[key]\n    }\n\n    // remove customEvents\n    for (let key in this.customEvents) {\n      evt = this.customEvents[key]\n      this.off(key)\n    }\n\n    // other object\n    this.cursor = null\n    this.toolbar = null\n\n    // ExpansionPanel\n    for (let key in this) {\n      if (this[key] instanceof ExpansionPanel) {\n        this[key] = null\n      }\n    }\n\n    // Node\n    this.$editor.remove()\n  },\n\n  /**\n   * set content height\n   * @param height\n   */\n  setHeight (height) {\n    this.$content.css('height', typeof height === 'number' ? (height + 'px') : height)\n    this.emit('heightChange', this)\n  },\n\n  /**\n   * get base64 images from this.$content\n   * @returns {Array}\n   */\n  getBase64Images () {\n    const arr = []\n    const $imgs = this.$content.find('img')\n    let img, base64\n    for (let i = 0; i < $imgs.length; i++) {\n      img = $imgs[i]\n      base64 = img.src\n      if (/^data:.+?;base64,/.test(base64)) {\n        arr.push({\n          id: img.id,\n          base64: base64,\n          blob: base64ToBlobData(base64)\n        })\n      }\n    }\n    return arr\n  },\n\n  /**\n   * 设置指定id图片src\n   * @param id\n   * @param src\n   * @returns {boolean}\n   */\n  setImageSrc (id, src) {\n    let img = this.$content.find('#' + id)[0]\n    if (img) {\n      img.src = src\n      img.removeAttribute('id')\n      return true\n    }\n    return false\n  }\n}\n\nexport default ZxEditor\n","/**\n * Created by Capricorncd.\n * User: https://github.com/capricorncd\n * Date: 2019/04/16 20:28\n */\nimport { emit, off, on } from '../custom-events'\nimport { getPasteText } from '../events/paste'\nimport { base64ToBlobData, blobToUrl, fileToBase64 } from '../image-handler/index'\nimport util from '../util/index'\n\nexport function extendPrototypes (ZxEditor) {\n  // custom events\n  ZxEditor.prototype.on = on\n  ZxEditor.prototype.emit = emit\n  ZxEditor.prototype.off = off\n  // static method\n  ZxEditor.prototype.getPasteText = getPasteText\n  // static utils\n  for (let key in util) {\n    if (util.hasOwnProperty(key)) {\n      ZxEditor.prototype[key] = util[key]\n    }\n  }\n  ZxEditor.prototype.blobToUrl = blobToUrl\n  ZxEditor.prototype.base64ToBlobData = base64ToBlobData\n  ZxEditor.prototype.fileToBase64 = fileToBase64\n}\n","/**\n * Created by Capricorncd.\n * User: https://github.com/capricorncd\n * Date: 2019/04/25 21:29\n */\nexport function onWatcher () {\n  /**\n   * *********************************\n   * toolbar change\n   * *********************************\n   */\n  this.on('toolbarShow', toolbar => {\n    this.$content.css('padding-bottom', toolbar.height + 'px')\n  })\n  this.on('toolbarHide', () => {\n    this.$content.css('padding-bottom', 0)\n  })\n}\n","/**\n * Created by Capricorncd.\n * User: https://github.com/capricorncd\n * Date: 2019/04/15 21:49\n */\nimport $ from '../dom-class'\n\nexport function initDom (options) {\n  // content\n  this.$content = $(`<div class=\"zx-editor-content-wrapper is-empty\" contenteditable=\"${options.editable}\"><section><br></section></div>`)\n\n  // editor\n  this.$editor = $(`<div class=\"zx-editor\"></div>`)\n\n  // append to $eidtor\n  this.$editor.append(this.$content)\n  // expansion-panel\n\n  // append to $wrapper\n  this.$wrapper.append(this.$editor)\n}\n","/**\n * Created by Capricorncd.\n * User: https://github.com/capricorncd\n * Date: 2019/04/15 21:46\n */\nimport $ from '../dom-class'\n\nexport function initStyle (options) {\n  let style = ''\n  /**\n   * *****************************************\n   * append style\n   * *****************************************\n   */\n  // line-height, caret-color\n  if (options.lineHeight || options.cursorColor) {\n    let lineHeight = options.lineHeight ? `line-height:${options.lineHeight};` : ''\n    let caretColor = options.cursorColor ? `caret-color:${options.cursorColor}` : ''\n    style += `.zx-editor .zx-editor-content-wrapper{${lineHeight + caretColor}}`\n  }\n  if (options.padding) {\n    style += `.zx-editor .zx-editor-content-wrapper > section{padding:${options.padding};}`\n  }\n  // placeholder\n  if (options.placeholder || options.placeholderColor) {\n    let content = options.placeholder ? `content:'${options.placeholder}';` : ''\n    let color = options.placeholderColor ? `color:${options.placeholderColor};` : ''\n    style += `.zx-editor .zx-editor-content-wrapper.is-empty:before{${content + color}}`\n  }\n  if (options.borderColor) {\n    style += `.zx-editor .border-top:before, .zx-editor .border-bottom:after {border-color: ${options.borderColor}`\n  }\n  /**\n   * *****************************************\n   * editor $content\n   * *****************************************\n   */\n  if (style) $('head').append(`<style type=\"text/css\">${style}</style>`)\n  /**\n   * *****************************************\n   * set css\n   * *****************************************\n   */\n  let heightDiff = this.$wrapper.outerHeight(true) - this.$wrapper.height()\n  this.setHeight(options.height ? options.height : window.innerHeight - heightDiff)\n}\n"],"names":["unique","arr","uniqueArray","i","length","indexOf","push","changeNodeName","oldNode","tagName","oldNodeName","nodeName","toLowerCase","util","strip","TypeError","el","document","createElement","nodeType","appendChild","className","id","style","getAttribute","setAttribute","innerHTML","parentNode","replaceChild","regTrim","int","n","num","parseInt","isNaN","trim","str","toString","replace","isObject","obj","isAbsolute","isObj","_typeof","isElement","removeHtmlTags","slice","ArrayLike","index","call","toHump","match","$1","console","log","toUpperCase","doc","body","addEventListener","removeEventListener","activeElement","blur","querySelector","querySelectorAll","getElementById","createEvent","initEvent","children","childNodes","getElementsByTagName","location","hash","win","window","navigator","userAgent","history","CustomEvent","this","getComputedStyle","getPropertyValue","Image","Date","screen","setTimeout","clearTimeout","ZxEditorQuery","selector","context","doms","tempDiv","test","Array","isArray","every","item","forEach","_this","prototype","constructor","j","$","is","closest","parents","eq","len","find","found","foundElements","firstChild","lastChild","next","nextElementSibling","parent","addClass","split","cls","_this2","classList","add","removeClass","_this3","remove","hasClass","contains","attr","attrs","value","arguments","removeAttr","removeAttribute","data","key","dataStorage","val","append","newChild","k","appendTo","insertAfter","after","insertBefore","nextSibling","cloneNode","before","prepend","prependTo","removeChild","compareWith","matches","webkitMatchesSelector","msMatchesSelector","isTextNode","isEmpty","text","isFirstChildren","target","isLastChildren","isInChild","$parent","$item","$child","fn","thisArg","textContent","html","hide","display","show","on","args","eventType","useCapture","attachEvent","off","detachEvent","trigger","events","eventData","event","evt","detail","bubbles","cancelable","e","dispatchEvent","css","props","prop","styles","width","innerWidth","parseFloat","outerWidth","includeMargins","offsetWidth","height","innerHeight","outerHeight","offsetHeight","offset","box","getBoundingClientRect","clientTop","clientLeft","scrollTop","scrollY","scrollLeft","scrollX","top","left","CursorClass","selection","range","currentNode","timer","$el","setRange","init","getSelection","getRangeAt","Range","removeAllRanges","setStart","collapse","addRange","getCurrentNode","endContainer","startOffset","DEF_OPTS","head","headHeight","headTitle","name","ExpansionPanel","options","zxEditor","ZxEditor","opts","Object","assign","editorInstance","expansionPanels","visible","$head","$body","$switch","$eventHandlers","$target","type","handler","$editor","getPasteText","Promise","resolve","clipboardData","pasteStr","items","getAsString","counter","count","handleEvents","contentPaste","$content","preventDefault","then","insertElm","bind","windowResize","toolbar","emit","contentInput","_checkEmpty","contentFocus","toolbarBeenFixed","contentBlur","capture","notifyName","customEvents","notifyArr","apply","findIndex","splice","getImageInfo","base64","file","orientation","callback","img","src","onload","canvas","ctx","getContext","imgWidth","imgHeight","rotate","Math","PI","drawImage","toDataURL","result","element","rotateAndToBase64","onerror","createCanvas","p","cw","ch","sx","sy","sw","sh","ratio","numerator","denominator","DEF_OPTIONS","imageMaxSize","ignoreGif","forceResize","winHeight","base64ToBlobData","base64Data","onlyData","RegExp","$2","atob","ia","Uint8Array","charCodeAt","Blob","fileToBase64","reject","File","EXIF","handleFile","getData","info","getAllTags","Orientation","blobToUrl","blob","URL","createObjectURL","reader","FileReader","readAsDataURL","res","size","imageInfo","dataType","iw","ih","targetWidth","targetHeight","scaling","canvasWidth","canvasHieght","floor","computeCropInfo","url","rawData","handleImageData","RangeError","IPHONEX_BOTTOM_OFFSET_HEIGHT","DEF_BTN_OPTS","innerHtml","Toolbar","toolbarHeight","DEF_COLORS","black","gray","red","yellow","green","blue","purple","initToolbar","toolbarBtns","addButton","$selectPictureLabel","$selectPictrueInput","input","imageSectionTemplate","imageSectionTemp","imageOptions","imageMaxWidth","files","customizePictureHandler","alt","COLORS","textStyleColors","colorWrapper","panelBody","textStylePanelParams","textStylePanel","disableBackspaceDelete","editable","fixedHeight","params","$btn","$btns","eventHandlerKey","placeholder","placeholderColor","lineHeight","padding","cursorColor","borderColor","_options","Error","$wrapper","version","hasOwnProperty","extendPrototypes","caretColor","content","color","heightDiff","setHeight","cursor","newRangeEl","newRangeOffset","$rangeNode","rangeOffset","rangeNodeStr","tmpStr","substr","$newEl","$elm","$section","_checkChildSection","insertBlankLine","$tmp","setHtml","getHtml","getText","destroy","getBase64Images","$imgs","setImageSrc"],"mappings":"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"}